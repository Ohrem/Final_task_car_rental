<?xml version="1.0" encoding="UTF-8" ?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
		http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">
    <changeSet id="1" author="ohrem25032002@gmail.com">
        <sql>
            CREATE TABLE IF NOT EXISTS `car` (
            `id` BIGINT(19) PRIMARY KEY NOT NULL,
            `brand` VARCHAR(64) NOT NULL,
            `model` VARCHAR(64) NOT NULL,
            `color` VARCHAR(64) NOT NULL,
            `price` DECIMAL NOT NULL,
            `isAvailable` BIT(1)
            );
        </sql>
    </changeSet>
    <changeSet id="2" author="ohrem25032002@gmail.com">
        <sql>
            CREATE TABLE IF NOT EXISTS `payment` (
            `id` BIGINT(19),
            `paymentDate` DATE NOT NULL,
            `paymentSum` DECIMAL NOT NULL,
            `isPaid` BIT(1),
            PRIMARY KEY (`id`)
            );
        </sql>
    </changeSet>
    <changeSet id="3" author="ohrem25032002@gmail.com">
        <sql>
            CREATE TABLE IF NOT EXISTS `app_user` (
                `id` BIGINT(19) PRIMARY KEY,
                `name` VARCHAR(64) NOT NULL,
                `surname` VARCHAR(64) NOT NULL,
                `email` VARCHAR(64) UNIQUE NOT NULL,
                `password` VARCHAR (64) NOT NULL,
                `phone` VARCHAR(64) NOT NULL,
                `role` VARCHAR(64) NOT NULL,
                `balance` DECIMAL
                );
        </sql>
    </changeSet>
    <changeSet id="4" author="ohrem25032002@gmail.com">
        <sql>
            CREATE TABLE IF NOT EXISTS `orders` (
            `id` BIGINT(19) PRIMARY KEY,
            `car_id` BIGINT(19) NOT NULL,
            `payment_id` BIGINT(19) NOT NULL,
            `user_id` BIGINT(19) NOT NULL,
            `begin_date` DATE,
            `end_date` DATE,
            `message` VARCHAR(64) NOT NULL,
            CONSTRAINT `f_car_id` FOREIGN KEY (`car_id`)
                REFERENCES `car` (`id`)
                 ON DELETE CASCADE
                 ON UPDATE CASCADE,
            CONSTRAINT `paymentId` FOREIGN KEY (`payment_id`)
                REFERENCES `payment` (`id`)
                 ON DELETE CASCADE
                 ON UPDATE CASCADE,
            CONSTRAINT `f_user_id` FOREIGN KEY (`user_id`)
                REFERENCES `app_user` (`id`)
                 ON DELETE CASCADE
                 ON UPDATE CASCADE
            );
        </sql>
    </changeSet>
    <changeSet id="5" author="ohrem25032002@gmail.com">
        <sql>
            CREATE TABLE IF NOT EXISTS `user_photo`
            (
                `ID`         VARCHAR(256) PRIMARY KEY NOT NULL,
                `user_id`    BIGINT(19)               NOT NULL,
                `user_photo` MEDIUMBLOB               NOT NULL,
                CONSTRAINT `user_photo`
                FOREIGN KEY (`user_id`)
                REFERENCES `app_user` (`id`)
                ON DELETE CASCADE
                ON UPDATE CASCADE
                );
        </sql>
    </changeSet>
    <changeSet id="5" author="ohrem25032002@gmail.com">
        <sql>
            CREATE TABLE IF NOT EXISTS `user_photo`
            (
                `ID`         VARCHAR(256) PRIMARY KEY NOT NULL,
                `user_id`    BIGINT(19)               NOT NULL,
                `user_photo` MEDIUMBLOB               NOT NULL,
                CONSTRAINT `user_photo`
                FOREIGN KEY (`user_id`)
                REFERENCES `app_user` (`id`)
                ON DELETE CASCADE
                ON UPDATE CASCADE
                );
        </sql>
    </changeSet>
    <changeSet id="6" author="ohrem25032002@gmail.com">
        <sql>
            INSERT INTO app_user VALUES (
              '1',
              'Roman',
              'Ohremchuk',
              'ohrem25032002@gmail.com',
              '{noop}root',
              '+375447714261',
              'ADMIN',
              '160.12'
         );
        </sql>
    </changeSet>
</databaseChangeLog>